!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BBAuthClient=t():e.BBAuthClient=t()}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(6)),o(n(7))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i="https://signin.blackbaud.com/signin/",s="https://host.nxt.blackbaud.com/errors/",r=encodeURIComponent;function a(e){let t=`${i}?redirectUrl=${r(location.href)}`;return e&&(t+="&inactivity=1"),t}t.BBAuthNavigator=class{static navigate(e,t){t?location.replace(e):location.href=e}static redirectToSignin(e){let t=a();e&&(t+="&"+function(e){const t=[];for(const n in e)e.hasOwnProperty(n)&&t.push(`${r(n)}=${r(e[n])}`);return t.join("&")}(e)),this.navigate(t)}static redirectToSignoutForInactivity(){const e=a(!0),t=`${i}sign-out?redirectUrl=${r(e)}`;this.navigate(t)}static redirectToError(e){let t,n;switch(e){case o.BBAuthTokenErrorCode.InvalidEnvironment:n="invalid_env",t="security";break;default:t="broken"}let i=`${s}${t}?source=auth-client&url=${r(location.href)}`;n&&(i+=`&code=${r(n)}`),this.navigate(i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o={"bryonwilkins.com":"https://sts.bryonwilkins.com"},i="https://s21aidntoken00blkbapp01.nxt.blackbaud.com";t.BBAuthGetDomain=class{static getSTSDomain(e=window.location.hostname){return e in o?o[e]:i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BBAuthDomUtility=class{static addCss(e){const t=document.createElement("style");return t.appendChild(document.createTextNode(e)),document.head.appendChild(t),t}static addIframe(e,t,n){const o=document.createElement("iframe");return o.className=t,o.title=n,o.src=e,this.addElToBodyTop(o),o}static removeCss(e){this.removeEl(e,document.head)}static removeEl(e,t=document.body){t.contains(e)&&t.removeChild(e)}static addElToBodyTop(e){const t=document.body;t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o="https://host.nxt.blackbaud.com";function i(e,t){if(e.origin===o){const n=e.data;return!!n&&n.source===t}return!1}t.BBAuthInterop=class{static postOmnibarMessage(e,t,n){t.source="auth-client",e.contentWindow.postMessage(t,n||o)}static messageIsFromOmnibar(e){return i(e,"skyux-spa-omnibar")}static messageIsFromToastContainer(e){return i(e,"skyux-spa-omnibar-toast-container")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=n(2),s=n(1),r=i.BBAuthGetDomain.getSTSDomain()+"/session/csrf";function a(e,t,n,o){return(o||void 0===o&&n)&&((e=e||{})[t]=n),e}function c(e,t,n,i,s){let r;return r=a(r,"environment_id",n),r=a(r,"legal_entity_id",s),r=a(r,"permission_scope",i,!(!n&&!s||!i)),new Promise((n,i)=>{!function(e,t,n,i,s){const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(4===r.readyState)switch(r.status){case 0:s({code:o.BBAuthTokenErrorCode.Offline,message:"The user is offline."});break;case 200:i(r.responseText);break;case 401:s({code:o.BBAuthTokenErrorCode.NotLoggedIn,message:"The user is not logged in."});break;case 403:s({code:o.BBAuthTokenErrorCode.InvalidEnvironment,message:"The user is not a member of the specified environment."});break;default:r.status>=400&&s({code:o.BBAuthTokenErrorCode.Unspecified,message:"An unknown error occurred."})}},r.open("POST",e,!0),r.setRequestHeader(t.name,t.value),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Content-Type","application/json"),r.withCredentials=!0,n?r.send(JSON.stringify(n)):r.send()}(e,{name:"X-CSRF",value:t},r,e=>{const t=e?JSON.parse(e):void 0;n(t)},i)})}t.BBCsrfXhr=class{static request(e,t,n,i,a,d,u){return!a||i||d?new Promise((l,m)=>{new Promise((e,t)=>{u?e({csrf_token:"token_needed"}):c(r,"token_needed").then(e).catch(t)}).then(t=>c(e,t.csrf_token,i,a,d)).then(l).catch(e=>{if(n||e.code===o.BBAuthTokenErrorCode.Offline)m(e);else switch(e.code){case o.BBAuthTokenErrorCode.NotLoggedIn:s.BBAuthNavigator.redirectToSignin(t);break;default:s.BBAuthNavigator.redirectToError(e.code)}})}):Promise.reject({code:o.BBAuthTokenErrorCode.PermissionScopeNoEnvironment,message:"You must also specify an environment or legal entity when specifying a permission scope."})}static requestWithToken(e,t){return new Promise((n,o)=>{const i=new XMLHttpRequest;i.onreadystatechange=()=>{if(4===i.readyState)switch(i.status){case 200:n(JSON.parse(i.responseText));break;default:o()}},i.open("GET",e,!0),i.setRequestHeader("Authorization","Bearer "+t),i.setRequestHeader("Accept","application/json"),i.send()})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),i=/1bb:\/\/([a-z]{3})-([a-z0-9]{5})(-[a-z]{4}[0-9]{2})?\/(.*)/;class s{static getUrl(e,t){const n=i.exec(e);let o=e,s=t?t.zone:void 0;return s&&(s=s.replace("-","")),n&&(n[3]&&(s=n[3].substring(1)),o=`https://${n[1]}-${s}.app.blackbaud.net/${n[2]}/${n[4]}`),Promise.resolve(o)}static getToken(e){return s.getTokenInternal(e)}static clearTokenCache(){s.tokenCache={}}static getTokenInternal(e){e=e||{};const{forceNewToken:t,disableRedirect:n}=e;if(s.mock)return Promise.resolve("mock_access_token_auth-client@blackbaud.com");const i=function(e){const{envId:t,permissionScope:n,leId:o}=e;return"token|"+(o||"-")+"|"+(t||"-")+"|"+(n||"-")}(e),r=s.tokenCache[i]=s.tokenCache[i]||{},a=(new Date).valueOf();return!t&&r.lastToken&&r.expirationTime&&r.expirationTime-a>6e4?Promise.resolve(r.lastToken):(r.pendingLookupPromise||(r.pendingLookupPromise=o.BBAuthTokenIntegration.getToken(n,e.envId,e.permissionScope,e.leId).then(e=>(r.expirationTime=(new Date).valueOf()+1e3*e.expires_in,r.lastToken=e.access_token,r.pendingLookupPromise=null,r.lastToken)).catch(e=>{throw r.pendingLookupPromise=null,e})),r.pendingLookupPromise)}}s.mock=!1,s.tokenCache={},t.BBAuth=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.NotLoggedIn=1]="NotLoggedIn",e[e.InvalidEnvironment=2]="InvalidEnvironment",e[e.PermissionScopeNoEnvironment=3]="PermissionScopeNoEnvironment",e[e.Offline=4]="Offline"}(t.BBAuthTokenErrorCode||(t.BBAuthTokenErrorCode={}))},function(e,t,n){"use strict";function o(e){const t=e.split("."),n=[];for(const e of t){const t=parseInt(e,10)||0;n.push(t)}return n}Object.defineProperty(t,"__esModule",{value:!0});class i{static registerScript(e){return new Promise((t,n)=>{const o=document.createElement("script");o.onload=t,o.onerror=n,o.src=e,document.body.appendChild(o)})}static smartRegisterScript(e,t,n){return n&&function(e,t){const n=o(e),i=o(t);for(let e=0;e<n.length;e++)if(e<i.length){if(i[e]>n[e])return!0;if(i[e]<n[e])return!1}return!0}(t,n)?Promise.resolve():i.registerScript(e)}}t.BBOmnibarScriptLoader=i},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(0)),o(n(12)),o(n(14))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5),i=n(11),s=n(2);t.BBAuthTokenIntegration=class{static getToken(e,t,n,r){return this.hostNameEndsWith("blackbaud.com")?o.BBCsrfXhr.request(s.BBAuthGetDomain.getSTSDomain()+"/oauth2/token",void 0,e,t,n,r,!0):i.BBAuthCrossDomainIframe.getToken({disableRedirect:e,envId:t,leId:r,permissionScope:n})}static hostNameEndsWith(e){return this.getLocationHostname().substr(-e.length)===e}static getLocationHostname(){return window.location.hostname}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(3),i=n(1),s=n(7),r="https://s21aidntoken00blkbapp01.nxt.blackbaud.com/Iframes/CrossDomainAuthFrame.html",a="security-token-svc",c="auth-client";class d{static reset(){this.requestCounter=0,this.tokenRequests={},this.iframeReadyPromise=new Promise(e=>this.iframeReadyResolve=e),this.listenerSetup=!1}static TARGET_ORIGIN(){return this.TARGETORIGIN}static getOrMakeIframe(){return d.iframeEl=document.getElementById("auth-cross-domain-iframe"),d.iframeEl||(d.iframeEl=o.BBAuthDomUtility.addIframe(r,"auth-cross-domain-iframe",""),d.iframeEl.id="auth-cross-domain-iframe",d.iframeEl.hidden=!0),d.iframeEl}static getToken(e){return this.setupListenersForIframe(),this.getTokenFromIframe(this.getOrMakeIframe(),e)}static setupListenersForIframe(){this.listenerSetup||(window.addEventListener("message",e=>{const t=e.data,n=t.requestId,o=this.tokenRequests[n];if(t.source===a||t.origin===this.TARGET_ORIGIN())switch(t.messageType){case"ready":this.iframeReadyResolve(!0);break;case"error":this.handleErrorMessage(t.value,o.reject,o.args.disableRedirect);break;case"getToken":const e={access_token:t.value,expires_in:0};o.resolve(e)}}),this.listenerSetup=!0)}static getTokenFromIframe(e,t){return new Promise((n,o)=>{const i=this.requestCounter++;d.tokenRequests[i]={args:t,reject:o,resolve:n},d.iframeReadyPromise.then(()=>{e.contentWindow.postMessage({messageType:"getToken",requestId:i,source:c,value:t},d.TARGET_ORIGIN())})})}static handleErrorMessage(e,t,n){if(n)t(e);else switch(e.code){case s.BBAuthTokenErrorCode.Offline:t(e);break;case s.BBAuthTokenErrorCode.NotLoggedIn:i.BBAuthNavigator.redirectToSignin(void 0);break;default:i.BBAuthNavigator.redirectToError(e.code)}}}d.listenerSetup=!1,d.iframeReadyPromise=new Promise(e=>d.iframeReadyResolve=e),d.tokenRequests={},d.requestCounter=0,d.TARGETORIGIN="https://s21aidntoken00blkbapp01.nxt.blackbaud.com",t.BBAuthCrossDomainIframe=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=n(4),s=n(5),r=n(3),a=n(1);function c(e,t,n,s){let a,c;function d(){r.BBAuthDomUtility.removeEl(c),r.BBAuthDomUtility.removeCss(a),c=a=void 0,window.removeEventListener("message",l)}function l(r){if(!i.BBAuthInterop.messageIsFromOmnibar(r))return;const a=r.data;switch(a.messageType){case"ready":i.BBAuthInterop.postOmnibarMessage(c,{messageType:"host-ready"}),i.BBAuthInterop.postOmnibarMessage(c,{contextDestinations:t,messageType:"context-provide"});break;case"get-token":u=a.tokenRequestId,l=a.disableRedirect,o.BBAuth.getToken({disableRedirect:l}).then(e=>{i.BBAuthInterop.postOmnibarMessage(c,{messageType:"token",token:e,tokenRequestId:u})},e=>{i.BBAuthInterop.postOmnibarMessage(c,{messageType:"token-fail",reason:e,tokenRequestId:u})});break;case"welcome-cancel":d(),s({reason:"canceled"});break;case"welcome-environment-selected":d(),setTimeout(()=>{e.envId=a.envId,n(e)},10)}var u,l}a=r.BBAuthDomUtility.addCss("\n.sky-omnibar-welcome-iframe {\n  background-color: #fff;\n  border: none;\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n  z-index: 10000;\n}\n"),function(){const t=u.url+"?hosted=1&svcid="+encodeURIComponent(e.svcId)+"&url="+encodeURIComponent(e.url);c=r.BBAuthDomUtility.addIframe(t,"sky-omnibar-welcome-iframe","Welcome")}(),window.addEventListener("message",l)}function d(){a.BBAuthNavigator.redirectToError(o.BBAuthTokenErrorCode.InvalidEnvironment)}class u{static ensureContext(e){const{envId:t,envIdRequired:n,leId:i,leIdRequired:r,svcId:a}=e;return!t&&n||!i&&r?new Promise((t,n)=>{a?o.BBAuth.getToken().then(o=>{let i="https://s21anavnavaf00blkbapp01.sky.blackbaud.com/user/destinations?svcid="+encodeURIComponent(a);e.url&&(i+="&referringurl="+encodeURIComponent(e.url)),s.BBCsrfXhr.requestWithToken(i,o).then(o=>{const i=o&&o.items,s=i&&i.length;1===s?(e.url=i[0].url,t(e)):s>1?c(e,o,t,n):d()})}):d()}):Promise.resolve(e)}}u.url="https://host.nxt.blackbaud.com/omnibar/welcome",t.BBContextProvider=u},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(15)),o(n(26)),o(n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(16),i=n(0),s=n(4),r=n(1),a=n(3),c=n(19),d=n(23),u=n(24),l=n(25),m="sky-omnibar-iframe-expanded",p="sky-omnibar-loading";let h,f,b,v,B,g,y,k,I,T,A;function w(){v=a.BBAuthDomUtility.addIframe(B.url||"https://host.nxt.blackbaud.com/omnibar/",`sky-omnibar-iframe ${p}`,"Navigation")}function O(){const e=document.location.href;s.BBAuthInterop.postOmnibarMessage(v,{href:e,messageType:"location-change"}),l.BBOmnibarToastContainer.updateUrl(e)}function E(){s.BBAuthInterop.postOmnibarMessage(v,{messageType:"push-notifications-open"})}function _(){k||(k=!0,i.BBAuth.getToken({disableRedirect:!0,envId:B.envId,leId:B.leId,permissionScope:"Notifications"}).then(e=>{!function(e){let t=o(e)["1bb.entitlements"];return!!t&&(t=Array.isArray(t)?t:[t]).indexOf("notif")>-1}(e)?k=!1:l.BBOmnibarToastContainer.init({envId:B.envId,leId:B.leId,navigateCallback:P,navigateUrlCallback:x,openMenuCallback:E,svcId:B.svcId,url:document.location.href}).then(()=>{u.BBOmnibarPushNotifications.connect(B.leId,B.envId,e=>{s.BBAuthInterop.postOmnibarMessage(v,{messageType:"push-notifications-update",pushNotifications:e}),l.BBOmnibarToastContainer.showNewNotifications(e),I=e&&e.notifications&&e.notifications.filter(e=>!e.isRead).length,U()})})}).catch(()=>{k=!1}))}function C(){function e(e){s.BBAuthInterop.postOmnibarMessage(v,{messageType:"refresh-user",token:e}),e?_():k&&(l.BBOmnibarToastContainer.destroy(),u.BBOmnibarPushNotifications.disconnect(),k=!1)}i.BBAuth.clearTokenCache(),i.BBAuth.getToken({disableRedirect:!0,forceNewToken:!0}).then(e).catch(()=>e(void 0))}function N(){d.BBOmnibarUserActivityPrompt.show({sessionRenewCallback:()=>{c.BBOmnibarUserActivity.userRenewedSession()}})}function R(){d.BBOmnibarUserActivityPrompt.hide()}function S(){c.BBOmnibarUserActivity.startTracking(C,N,R,B.allowAnonymous,g)}function P(e){const t=B.nav;t&&t.beforeNavCallback&&!1===t.beforeNavCallback(e)||r.BBAuthNavigator.navigate(e.url)}function x(e){r.BBAuthNavigator.navigate(e)}function M(e){if(!s.BBAuthInterop.messageIsFromOmnibar(e))return;const t=e.data,n=B.nav;switch(t.messageType){case"ready":s.BBAuthInterop.postOmnibarMessage(v,{messageType:"host-ready"}),function(){const e=history.pushState,t=history.replaceState;history.pushState=function(){const t=e.apply(history,arguments);return O(),t},history.replaceState=function(){const e=t.apply(history,arguments);return O(),e}}(),s.BBAuthInterop.postOmnibarMessage(v,{compactNavOnly:B.compactNavOnly,enableHelp:B.enableHelp,envId:B.envId,hideResourceLinks:B.hideResourceLinks,leId:B.leId,localNavItems:n&&n.localNavItems,localNotifications:!!B.notifications,localSearch:!!B.onSearch,messageType:"nav-ready",navVersion:B.navVersion,services:n&&n.services,svcId:B.svcId,theme:B.theme}),function(){const e=B.notifications;e&&e.onReady({updateNotifications:e=>{s.BBAuthInterop.postOmnibarMessage(v,{messageType:"notifications-update",notifications:e})}})}(),_(),O(),y();break;case"display-ready":f.classList.remove(p),v.classList.remove(p);break;case"expand":v.classList.add(m);break;case"collapse":v.classList.remove(m);break;case"navigate-url":x(t.url);break;case"navigate":P(t.navItem);break;case"search":d=t.searchArgs,B.onSearch&&B.onSearch(d).then(e=>{s.BBAuthInterop.postOmnibarMessage(v,{messageType:"search-results",results:e})});break;case"get-token":r=t.tokenRequestId,a=t.disableRedirect,i.BBAuth.getToken({disableRedirect:a}).then(e=>{S(),s.BBAuthInterop.postOmnibarMessage(v,{messageType:"token",token:e,tokenRequestId:r})},e=>{S(),s.BBAuthInterop.postOmnibarMessage(v,{messageType:"token-fail",reason:e,tokenRequestId:r})});break;case"help-open":!function(){const e=window.BBHELP;e&&e.HelpWidget.open()}();break;case"notification-read":!function(e){const t=B.notifications;t&&t.onNotificationRead&&t.onNotificationRead(e)}(t.notification);break;case"push-notifications-change":o=t.notifications,u.BBOmnibarPushNotifications.updateNotifications(o);break;case"session-renew":c.BBOmnibarUserActivity.userRenewedSession();break;case"environment-update":!function(e){const t="sky-omnibar-environment-visible",n=document.body.classList;e=e||"",h.innerText=e,e?n.add(t):n.remove(t)}(t.name);break;case"legacy-keep-alive-url-change":g=t.url,S();break;case"selected-service-update":T=t.serviceName,U()}var o,r,a,d}function U(){if(A){const e=A.slice();T&&e.push(T);let t=e.join(" - ");I&&(t=`(${I}) ${t}`),document.title=t}}t.BBOmnibar=class{static load(e){return B=B=e,g=B.legacyKeepAliveUrl,new Promise(e=>{y=e,function(){let e="background: linear-gradient(to right, #71bf44 0, #31b986 50%, #00b2ec 100%);",t="#4d5259";const n=B.theme;if(n){const o=n.accent;t=n.backgroundColor||t,!1===o?e="display: none;":o&&o.color&&(e=`background-color: ${o.color};`)}b=a.BBAuthDomUtility.addCss(`\nbody {\n  margin-top: 50px;\n}\n\n#bb-help-container {\n  padding-top: 1px;\n}\n\n.sky-omnibar-iframe,\n.sky-omnibar-placeholder {\n  border: none;\n  height: 50px;\n  width: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 1000;\n}\n\n.sky-omnibar-placeholder {\n  background-color: ${t};\n  display: none;\n}\n\n.sky-omnibar-placeholder-accent {\n  height: 5px;\n  ${e}\n}\n\n.sky-omnibar-placeholder.${p} {\n  display: block;\n}\n\n.sky-omnibar-iframe.${p} {\n  visibility: hidden;\n}\n\n.${m} {\n  height: 100%;\n}\n\n.sky-omnibar-environment {\n  background-color: #e1e1e3;\n  color: #282b31;\n  font-family: "Blackbaud Sans", "Open Sans", "Helvetica Neue", Arial, sans-serif;\n  font-size: 12px;\n  font-weight: 400;\n  height: 0;\n  line-height: 24px;\n  overflow: hidden;\n  padding: 0 15px;\n  text-align: right;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.sky-omnibar-environment-visible .sky-omnibar-environment {\n  height: 24px;\n}\n`)}(),(f=document.createElement("div")).className=`sky-omnibar-placeholder ${p}`,f.innerHTML='<div class="sky-omnibar-placeholder-accent"></div>',document.body.appendChild(f),(h=document.createElement("div")).className="sky-omnibar-environment",a.BBAuthDomUtility.addElToBodyTop(h),w(),window.addEventListener("message",M)})}static update(e){s.BBAuthInterop.postOmnibarMessage(v,{messageType:"update",updateArgs:e})}static setTitle(e){A=e&&e.titleParts,U()}static destroy(){l.BBOmnibarToastContainer.destroy(),u.BBOmnibarPushNotifications.disconnect(),a.BBAuthDomUtility.removeEl(f),a.BBAuthDomUtility.removeEl(v),a.BBAuthDomUtility.removeEl(h),a.BBAuthDomUtility.removeCss(b),window.removeEventListener("message",M),B=b=f=v=h=y=k=I=A=T=void 0}}},function(e,t,n){"use strict";var o=n(17);function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new i("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[n]))}catch(e){throw new i("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=i},function(e,t,n){var o=n(18);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(o(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return o(t)}}},function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new o("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,s,r=0,a=0,c="";s=t.charAt(a++);~s&&(i=r%4?64*i+s:s,r++%4)?c+=String.fromCharCode(255&i>>(-2*r&6)):0)s=n.indexOf(s);return c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(20),i=n(21),s=n(22),r=n(5),a=n(2),c=n(1);let d,u,l,m,p,h,f,b,v,B,g,y,k,I,T="";function A(){b=Date.now()}function w(e){e.clientX===u&&e.clientY===l||(u=e.clientX,l=e.clientY,A())}function O(){const e=Date.now();(!v||e-v>N.MIN_RENEWAL_RETRY)&&(v=e,r.BBCsrfXhr.request(a.BBAuthGetDomain.getSTSDomain()+"/session/renew",{inactivity:1}).catch(()=>void 0))}function E(){f=!0,h()}function _(){f=!1,A(),m()}function C(){I?c.BBAuthNavigator.navigate(I):c.BBAuthNavigator.redirectToSignoutForInactivity()}class N{static startTracking(e,t,n,r,a){d&&r===g&&a===y||(N.stopTracking(),p=e,h=t,m=n,g=r,y=a,document.addEventListener("keypress",A),document.addEventListener("mousemove",w),g||O(),B=setInterval(()=>{i.BBOmnibarUserSessionExpiration.getSessionExpiration(T,k,g).then(e=>{d&&o.BBOmnibarUserActivityProcessor.process({allowAnonymous:g,closeInactivityPrompt:_,expirationDate:e,inactivityPromptDuration:N.INACTIVITY_PROMPT_DURATION,isShowingInactivityPrompt:f,lastActivity:b,maxSessionAge:N.MAX_SESSION_AGE,minRenewalAge:N.MIN_RENEWAL_AGE,redirectForInactivity:C,renewSession:O,showInactivityPrompt:E})})},N.ACTIVITY_TIMER_INTERVAL),s.BBOmnibarUserSessionWatcher.start(r,a,p,e=>{k=e.legacyTtl,T=e.refreshId,I=e.legacySigninUrl}),d=!0)}static userRenewedSession(){_(),O()}static stopTracking(){s.BBOmnibarUserSessionWatcher.stop(),i.BBOmnibarUserSessionExpiration.reset(),document.removeEventListener("keypress",A),document.removeEventListener("mousemove",w),B&&(clearInterval(B),B=void 0),d=u=l=b=v=f=p=h=m=g=y=void 0}}N.ACTIVITY_TIMER_INTERVAL=1e3,N.MIN_RENEWAL_RETRY=6e4,N.INACTIVITY_PROMPT_DURATION=12e4,N.MIN_RENEWAL_AGE=3e5,N.MAX_SESSION_AGE=54e5,t.BBOmnibarUserActivity=N},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BBOmnibarUserActivityProcessor=class{static process(e){const{allowAnonymous:t,closeInactivityPrompt:n,expirationDate:o,inactivityPromptDuration:i,isShowingInactivityPrompt:s,lastActivity:r,maxSessionAge:a,minRenewalAge:c,redirectForInactivity:d,renewSession:u,showInactivityPrompt:l}=e,m=Date.now();if(null===o)return;!t&&m>o&&d();const p=o-i,h=o-a+c;s?m<p&&n():r>h?u():!t&&m>p&&l()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(5);let s;t.BBOmnibarUserSessionExpiration=class{static getSessionExpiration(e,t,n){const r=function(e,t){if(s&&s.refreshId===e&&s.allowAnonymous===t)return s.promise;const n=new Promise((e,n)=>{i.BBCsrfXhr.request(o.BBAuthGetDomain.getSTSDomain()+"/session/ttl",void 0,t).then(t=>{const n=null===t?null:Date.now()+1e3*t;e(n)},()=>{e(null)})});return s={allowAnonymous:t,promise:n,refreshId:e},n}(e,n);return new Promise((e,n)=>{r.then(n=>{let o;if(null===n)o=null;else if("number"==typeof t){const e=Date.now()+t;o=Math.min(n,e)}else o=n;e(o)})})}static reset(){s=void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),i=n(1),s=n(2);let r,a,c,d,u,l,m,p,h={};function f(e){if(e){const t=e.split("://");return`${t[0]}://${t[1].split("/")[0]}`}}function b(e,t){const n=document.createElement("iframe");return n.className=e,n.width="0",n.height="0",n.frameBorder="0",n.src=t,n.tabIndex=-1,n.setAttribute("aria-hidden","true"),document.body.appendChild(n),n}function v(e){if("string"==typeof e.data){let t;try{t=JSON.parse(e.data)}catch(e){return}if("session_change"===t.messageType){const e=t.message,n=e&&e.sessionId,s=e&&e.refreshId;n||u||(p?i.BBAuthNavigator.navigate(p):i.BBAuthNavigator.redirectToSignin()),void 0!==h.refreshId&&s!==h.refreshId&&function(e){m&&o.BBAuthInterop.postOmnibarMessage(m,e,f(a))}({messageType:"session-refresh"}),void 0!==h.sessionId&&n!==h.sessionId&&c(),h.refreshId=s,h.sessionId=n,d(h)}}}function B(e){switch(e.origin){case g.IDENTITY_SECURITY_TOKEN_SERVICE_ORIGIN:v(e);break;case f(a):!function(e){const t=e.data;switch(t.messageType){case"ready":h.legacyTtl=t.ttl,p=t.signinUrl,d(h)}}(e)}}class g{static start(e,t,n,o){r&&e===u&&t===a||(g.stop(),u=e,c=n,a=t,d=o,function(){const e=g.IDENTITY_SECURITY_TOKEN_SERVICE_ORIGIN+"/SessionWatcher.html?origin="+encodeURIComponent(location.origin);l=b("sky-omnibar-iframe-session-watcher",e)}(),a&&(m=b("sky-omnibar-iframe-legacy-keep-alive",a)),window.addEventListener("message",B,!1),r=!0)}static stop(){window.removeEventListener("message",B,!1),l&&(document.body.removeChild(l),l=void 0),m&&(document.body.removeChild(m),m=void 0),h={},r=u=c=a=p=d=void 0}}g.IDENTITY_SECURITY_TOKEN_SERVICE_ORIGIN=s.BBAuthGetDomain.getSTSDomain(),t.BBOmnibarUserSessionWatcher=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(3),i=n(4);let s,r,a;function c(e){if(!i.BBAuthInterop.messageIsFromOmnibar(e))return;switch(e.data.messageType){case"ready":i.BBAuthInterop.postOmnibarMessage(r,{messageType:"host-ready"}),r.classList.add("sky-omnibar-inactivity-iframe-ready");break;case"session-renew":a()}}class d{static show(e){this.hide(),a=e.sessionRenewCallback,s=o.BBAuthDomUtility.addCss("\n  .sky-omnibar-inactivity-iframe {\n    background-color: transparent;\n    border: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 100%;\n    z-index: 100000;\n    visibility: hidden;\n  }\n\n  .sky-omnibar-inactivity-iframe-ready {\n    visibility: visible;\n  }\n  "),function(){const e=d.url;r=o.BBAuthDomUtility.addIframe(e,"sky-omnibar-inactivity-iframe","Inactivity Prompt")}(),window.addEventListener("message",c)}static hide(){r&&(o.BBAuthDomUtility.removeEl(r),o.BBAuthDomUtility.removeCss(s),r=s=a=void 0,window.removeEventListener("message",c))}}d.url="https://host.nxt.blackbaud.com/omnibar/inactivity",t.BBOmnibarUserActivityPrompt=d},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(r,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(8);let r;class a{static connect(e,t,n){return o(this,void 0,void 0,(function*(){return r||(r=window.BBNotificationsClient?Promise.resolve():s.BBOmnibarScriptLoader.registerScript(this.NOTIFICATIONS_CLIENT_URL)),r.then(()=>{BBNotificationsClient.BBNotifications.init({tokenCallback:()=>i.BBAuth.getToken({disableRedirect:!0,envId:t,leId:e})}),BBNotificationsClient.BBNotifications.addListener(n)})}))}static disconnect(){return o(this,void 0,void 0,(function*(){return r?r.then(()=>{BBNotificationsClient.BBNotifications.destroy(),r=void 0}):Promise.resolve()}))}static updateNotifications(e){BBNotificationsClient.BBNotifications.updateNotifications(e)}}a.NOTIFICATIONS_CLIENT_URL="https://sky.blackbaudcdn.net/static/notifications-client/1/notifications-client.global.min.js",t.BBOmnibarPushNotifications=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),i=n(3),s=n(4),r="sky-omnibar-toast-container",a=`${r}-ready`,c=`${r}-empty`,d=20;let u,l,m,p,h,f;function b(e){const t=document.querySelector(e);return t?t.getBoundingClientRect().height:0}function v(){l&&s.BBAuthInterop.postOmnibarMessage(l,{href:f,messageType:"location-change"})}function B(e){if(!s.BBAuthInterop.messageIsFromToastContainer(e))return;const t=e.data;switch(t.messageType){case"toast-ready":s.BBAuthInterop.postOmnibarMessage(l,{messageType:"host-ready"}),s.BBAuthInterop.postOmnibarMessage(l,{envId:h.envId,leId:h.leId,messageType:"nav-ready",svcId:h.svcId}),v(),l.classList.add(a),p();break;case"get-token":n=t.tokenRequestId,i=t.disableRedirect,o.BBAuth.getToken({disableRedirect:i}).then(e=>{s.BBAuthInterop.postOmnibarMessage(l,{messageType:"token",token:e,tokenRequestId:n})},e=>{s.BBAuthInterop.postOmnibarMessage(l,{messageType:"token-fail",reason:e,tokenRequestId:n})});break;case"navigate-url":h.navigateUrlCallback(t.url);break;case"navigate":h.navigateCallback(t.navItem);break;case"toast-container-change":t.height>0?(l.style.height=t.height+"px",l.style.top=b(".sky-omnibar-iframe")+b(".sky-omnibar-environment")+d+"px",l.classList.remove(c)):l.classList.add(c);break;case"push-notifications-open":h.openMenuCallback()}var n,i}class g{static init(e){return h=e,f=e.url,m||(m=new Promise(e=>{p=e,l||(u=i.BBAuthDomUtility.addCss(`\n.${r} {\n  border: none;\n  display: none;\n  position: fixed;\n  right: 0px;\n  height: 0px;\n  width: 300px;\n  /* z-index is 1 less than omnibar so menus will display over top the toast container */\n  z-index: 999;\n}\n\n.${a} {\n  display: block;\n}\n\n.${c} {\n  visibility: hidden;\n}\n`),(l=document.createElement("iframe")).src=g.CONTAINER_URL,l.className=`${r} ${c}`,l.title="Toast container",document.body.appendChild(l),window.addEventListener("message",B))})),m}static showNewNotifications(e){s.BBAuthInterop.postOmnibarMessage(l,{messageType:"push-notifications-update",pushNotifications:e})}static updateUrl(e){f=e,v()}static destroy(){u&&i.BBAuthDomUtility.removeCss(u),l&&i.BBAuthDomUtility.removeEl(l),f=l=h=m=p=u=void 0,window.removeEventListener("message",B)}}g.CONTAINER_URL="https://host.nxt.blackbaud.com/omnibar/toast",t.BBOmnibarToastContainer=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(8);function i(){return window.jQuery}t.BBOmnibarLegacy=class{static load(e){return new Promise(t=>{const n=i(),s=n&&n.fn&&n.fn.jquery;o.BBOmnibarScriptLoader.smartRegisterScript("https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.js","2.1.0",s).then(()=>o.BBOmnibarScriptLoader.registerScript("https://cdnjs.cloudflare.com/ajax/libs/easyXDM/2.4.17.1/easyXDM.min.js")).then(()=>o.BBOmnibarScriptLoader.registerScript("https://signin.blackbaud.com/Omnibar.min.js")).then(()=>{document.body.classList.add("bb-omnibar-height-padding");const n=document.createElement("div");n.setAttribute("data-omnibar-el",""),document.body.appendChild(n),(e=e||{})["z-index"]=1e3,e.afterLoad=t,e.menuEl&&(e.menuEl=i()(e.menuEl)),BBAUTH.Omnibar.load(n,e)})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}])}));